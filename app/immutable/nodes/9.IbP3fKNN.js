import{s as oe,n as z,c as W,g as ce,e as O}from"../chunks/scheduler.nSpB3e7h.js";import{S as fe,i as ue,e as b,c as y,a as w,d as f,u as m,g as d,s as U,f as V,w as H,v as K,t as $,b as q,h as S,j as M}from"../chunks/index.EYyPxix3.js";import{C as J,S as X,$ as de,e as B}from"../chunks/apis.rP1ghAGS.js";import{g as Y}from"../chunks/assets.Kq_R9HF9.js";import{f as Z}from"../chunks/units.XFe2sYSS.js";function x(a,t,s){const l=a.slice();return l[7]=t[s],l}function ee(a,t,s){const l=a.slice();return l[10]=t[s],l}function te(a,t,s){const l=a.slice();return l[13]=t[s],l[15]=s,l}function he(a){let t,s,l,n,i,e,o,r,u;return{c(){t=b("div"),s=U(),l=b("div"),n=U(),i=b("div"),e=U(),o=b("div"),r=U(),u=b("div"),this.h()},l(c){t=y(c,"DIV",{class:!0}),w(t).forEach(f),s=V(c),l=y(c,"DIV",{class:!0}),w(l).forEach(f),n=V(c),i=y(c,"DIV",{class:!0}),w(i).forEach(f),e=V(c),o=y(c,"DIV",{class:!0}),w(o).forEach(f),r=V(c),u=y(c,"DIV",{class:!0}),w(u).forEach(f),this.h()},h(){m(t,"class","placeholder svelte-1fyixrn"),m(l,"class","placeholder svelte-1fyixrn"),m(i,"class","placeholder svelte-1fyixrn"),m(o,"class","placeholder svelte-1fyixrn"),m(u,"class","placeholder halfPlaceholder svelte-1fyixrn")},m(c,_){d(c,t,_),d(c,s,_),d(c,l,_),d(c,n,_),d(c,i,_),d(c,e,_),d(c,o,_),d(c,r,_),d(c,u,_)},p:z,d(c){c&&(f(t),f(s),f(l),f(n),f(i),f(e),f(o),f(r),f(u))}}}function _e(a){let t,s=B(a[0]),l=[];for(let n=0;n<s.length;n+=1)l[n]=ae(x(a,s,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();t=H()},l(n){for(let i=0;i<l.length;i+=1)l[i].l(n);t=H()},m(n,i){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(n,i);d(n,t,i)},p(n,i){if(i&7){s=B(n[0]);let e;for(e=0;e<s.length;e+=1){const o=x(n,s,e);l[e]?l[e].p(o,i):(l[e]=ae(o),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=s.length}},d(n){n&&f(t),K(l,n)}}}function le(a){let t,s,l,n,i=a[10].title+"",e,o,r;return{c(){t=b("hr"),s=U(),l=b("p"),n=b("b"),e=$(i),o=U(),r=b("hr"),this.h()},l(u){t=y(u,"HR",{class:!0}),s=V(u),l=y(u,"P",{class:!0});var c=w(l);n=y(c,"B",{});var _=w(n);e=q(_,i),_.forEach(f),c.forEach(f),o=V(u),r=y(u,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn"),m(l,"class","poll svelte-1fyixrn"),m(r,"class","split svelte-1fyixrn")},m(u,c){d(u,t,c),d(u,s,c),d(u,l,c),S(l,n),S(n,e),d(u,o,c),d(u,r,c)},p(u,c){c&1&&i!==(i=u[10].title+"")&&M(e,i)},d(u){u&&(f(t),f(s),f(l),f(o),f(r))}}}function me(a){let t,s,l,n,i,e=(a[10].choices[a[13].candidate].title||re(a[10],a[13].candidate))+"",o;return{c(){t=b("img"),n=U(),i=b("p"),o=$(e),this.h()},l(r){t=y(r,"IMG",{src:!0,alt:!0,class:!0}),n=V(r),i=y(r,"P",{});var u=w(i);o=q(u,e),u.forEach(f),this.h()},h(){O(t.src,s=a[10].choices[a[13].candidate].txImageUrl)||m(t,"src",s),m(t,"alt",l=a[10].choices[a[13].candidate].title),m(t,"class","svelte-1fyixrn")},m(r,u){d(r,t,u),d(r,n,u),d(r,i,u),S(i,o)},p(r,u){u&1&&!O(t.src,s=r[10].choices[r[13].candidate].txImageUrl)&&m(t,"src",s),u&1&&l!==(l=r[10].choices[r[13].candidate].title)&&m(t,"alt",l),u&1&&e!==(e=(r[10].choices[r[13].candidate].title||re(r[10],r[13].candidate))+"")&&M(o,e)},d(r){r&&(f(t),f(n),f(i))}}}function pe(a){let t,s,l=a[2]("profile.votes.unrevealed")+"",n;return{c(){t=b("p"),s=b("i"),n=$(l)},l(i){t=y(i,"P",{});var e=w(t);s=y(e,"I",{});var o=w(s);n=q(o,l),o.forEach(f),e.forEach(f)},m(i,e){d(i,t,e),S(t,s),S(s,n)},p(i,e){e&4&&l!==(l=i[2]("profile.votes.unrevealed")+"")&&M(n,l)},d(i){i&&f(t)}}}function ie(a){let t;return{c(){t=b("hr"),this.h()},l(s){t=y(s,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn")},m(s,l){d(s,t,l)},d(s){s&&f(t)}}}function se(a){let t,s=new Date(Number(a[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"",l,n,i=new Date(Number(a[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"",e,o,r,u,c,_=Number(Z(a[13].amount)).toLocaleString("en-US")+"",T,P,v,g,E,p,I,D,R,N;function C(...h){return a[4](a[7],...h)}function G(h,k){return h[13].candidate===null?pe:me}let F=G(a),j=F(a),L=a[10].votes.length>1&&a[15]<a[10].votes.length-1&&ie();return{c(){t=b("p"),l=$(s),n=$(`,
                                `),e=$(i),o=U(),r=b("hr"),u=U(),c=b("div"),T=$(_),P=U(),v=b("img"),E=U(),p=b("hr"),I=U(),D=b("div"),j.c(),R=U(),L&&L.c(),N=H(),this.h()},l(h){t=y(h,"P",{class:!0});var k=w(t);l=q(k,s),n=q(k,`,
                                `),e=q(k,i),k.forEach(f),o=V(h),r=y(h,"HR",{class:!0}),u=V(h),c=y(h,"DIV",{class:!0});var A=w(c);T=q(A,_),P=V(A),v=y(A,"IMG",{src:!0,alt:!0,class:!0}),A.forEach(f),E=V(h),p=y(h,"HR",{class:!0}),I=V(h),D=y(h,"DIV",{class:!0});var Q=w(D);j.l(Q),Q.forEach(f),R=V(h),L&&L.l(h),N=H(),this.h()},h(){m(t,"class","date svelte-1fyixrn"),m(r,"class","vertical svelte-1fyixrn"),O(v.src,g=Y(a[1].find(C)||a[1][0]).como)||m(v,"src",g),m(v,"alt","COMO"),m(v,"class","svelte-1fyixrn"),m(c,"class","como svelte-1fyixrn"),m(p,"class","vertical svelte-1fyixrn"),m(D,"class","choice svelte-1fyixrn")},m(h,k){d(h,t,k),S(t,l),S(t,n),S(t,e),d(h,o,k),d(h,r,k),d(h,u,k),d(h,c,k),S(c,T),S(c,P),S(c,v),d(h,E,k),d(h,p,k),d(h,I,k),d(h,D,k),j.m(D,null),d(h,R,k),L&&L.m(h,k),d(h,N,k)},p(h,k){a=h,k&1&&s!==(s=new Date(Number(a[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"")&&M(l,s),k&1&&i!==(i=new Date(Number(a[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"")&&M(e,i),k&1&&_!==(_=Number(Z(a[13].amount)).toLocaleString("en-US")+"")&&M(T,_),k&3&&!O(v.src,g=Y(a[1].find(C)||a[1][0]).como)&&m(v,"src",g),F===(F=G(a))&&j?j.p(a,k):(j.d(1),j=F(a),j&&(j.c(),j.m(D,null))),a[10].votes.length>1&&a[15]<a[10].votes.length-1?L||(L=ie(),L.c(),L.m(N.parentNode,N)):L&&(L.d(1),L=null)},d(h){h&&(f(t),f(o),f(r),f(u),f(c),f(E),f(p),f(I),f(D),f(R),f(N)),j.d(),L&&L.d(h)}}}function ne(a){let t,s,l=a[7].polls.length>1&&le(a),n=B(a[10].votes),i=[];for(let e=0;e<n.length;e+=1)i[e]=se(te(a,n,e));return{c(){l&&l.c(),t=U();for(let e=0;e<i.length;e+=1)i[e].c();s=H()},l(e){l&&l.l(e),t=V(e);for(let o=0;o<i.length;o+=1)i[o].l(e);s=H()},m(e,o){l&&l.m(e,o),d(e,t,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,o);d(e,s,o)},p(e,o){if(e[7].polls.length>1?l?l.p(e,o):(l=le(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null),o&7){n=B(e[10].votes);let r;for(r=0;r<n.length;r+=1){const u=te(e,n,r);i[r]?i[r].p(u,o):(i[r]=se(u),i[r].c(),i[r].m(s.parentNode,s))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(e){e&&(f(t),f(s)),l&&l.d(e),K(i,e)}}}function ae(a){let t,s,l,n=a[7].title+"",i,e,o,r,u,c,_,T,P=B(a[7].pollDetails),v=[];for(let g=0;g<P.length;g+=1)v[g]=ne(ee(a,P,g));return{c(){t=b("div"),s=b("div"),l=b("b"),i=$(n),e=U(),o=b("img"),c=U(),_=b("div");for(let g=0;g<v.length;g+=1)v[g].c();T=U(),this.h()},l(g){t=y(g,"DIV",{class:!0});var E=w(t);s=y(E,"DIV",{class:!0});var p=w(s);l=y(p,"B",{});var I=w(l);i=q(I,n),I.forEach(f),e=V(p),o=y(p,"IMG",{src:!0,alt:!0,class:!0}),p.forEach(f),c=V(E),_=y(E,"DIV",{class:!0});var D=w(_);for(let R=0;R<v.length;R+=1)v[R].l(D);D.forEach(f),T=V(E),E.forEach(f),this.h()},h(){O(o.src,r=a[7].bannerImageUrl)||m(o,"src",r),m(o,"alt",u=a[7].title),m(o,"class","svelte-1fyixrn"),m(s,"class","header svelte-1fyixrn"),m(_,"class","content svelte-1fyixrn"),m(t,"class","gravity svelte-1fyixrn")},m(g,E){d(g,t,E),S(t,s),S(s,l),S(l,i),S(s,e),S(s,o),S(t,c),S(t,_);for(let p=0;p<v.length;p+=1)v[p]&&v[p].m(_,null);S(t,T)},p(g,E){if(E&1&&n!==(n=g[7].title+"")&&M(i,n),E&1&&!O(o.src,r=g[7].bannerImageUrl)&&m(o,"src",r),E&1&&u!==(u=g[7].title)&&m(o,"alt",u),E&7){P=B(g[7].pollDetails);let p;for(p=0;p<P.length;p+=1){const I=ee(g,P,p);v[p]?v[p].p(I,E):(v[p]=ne(I),v[p].c(),v[p].m(_,null))}for(;p<v.length;p+=1)v[p].d(1);v.length=P.length}},d(g){g&&f(t),K(v,g)}}}function ve(a){let t;function s(i,e){return i[0]?_e:he}let l=s(a),n=l(a);return{c(){t=b("div"),n.c(),this.h()},l(i){t=y(i,"DIV",{class:!0});var e=w(t);n.l(e),e.forEach(f),this.h()},h(){m(t,"class","layout svelte-1fyixrn")},m(i,e){d(i,t,e),n.m(t,null)},p(i,[e]){l===(l=s(i))&&n?n.p(i,e):(n.d(1),n=l(i),n&&(n.c(),n.m(t,null)))},i:z,o:z,d(i){i&&f(t),n.d()}}}function ge(a,t){const s=e=>new Date(e.startDate).getTime()<=a.timestamp&&new Date(e.endDate).getTime()>=a.timestamp,l=t.polls.find(e=>e.pollIdOnChain==a.poll&&s(e));if(l)return l;const n=t.polls.find(e=>e.id==a.poll&&s(e));if(n)return n;const i=t.polls.find(e=>e.id-1==a.poll&&s(e));return i||t.polls.find(e=>e.id+1==a.poll&&s(e))}function re(a,t){const s=a.pollViewMetadata;if(s.slots){const l=s.choiceIdToSlotChoicesMapTable[t];return s.slots.map((n,i)=>{var e,o;return`${n.name}: ${(o=(e=s.slotChoices)==null?void 0:e.find(r=>r.id===l.slotChoiceIds[i]))==null?void 0:o.name}`}).join(", ")}return a.choices[t].id}function be(a,t,s){let l,n;W(a,de,c=>s(2,n=c));const i=ce("address");W(a,i,c=>s(5,l=c));let e,o;J.artists().then(c=>{s(1,o=c),r()});async function r(){const _=await(await fetch(`${J.URL}/gravity/v3`)).json(),T=[..._.upcoming,..._.ongoing,..._.past],E=(await(await fetch(X.URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
                    query {
                        votesConnection(orderBy: timestamp_DESC, where: {from_eq: "${l}"}) {
                            edges {
                                node {
                                    ${Object.keys(X.Vote).join(`
`)}
                                }
                            }
                        }
                    }
                `})})).json()).data.votesConnection.edges.map(I=>I.node).reduce((I,D)=>{const R=I.find(N=>N.votes.find(C=>C.poll===D.poll&&C.contract===D.contract));if(R)R.votes.unshift(D);else{const N=o.find(C=>C.contracts.Governor.toLowerCase()===D.contract);for(const C of T){if(C.artist!==(N==null?void 0:N.name))continue;const G=ge(D,C);if(G){I.push({...G,votes:[D],gravity:C});break}}}return I},[]),p=await Promise.all(E.map(async I=>(await(await fetch(`${J.URL}/gravity/v3/${I.gravity.artist}/gravity/${I.gravity.id}/polls/${I.id}`)).json()).pollDetail));s(0,e=p.reduce((I,D)=>{const R=I.find(C=>C.id===D.gravityId),N=E.find(C=>C.id===D.id).votes;return R?R.pollDetails.unshift({...D,votes:N}):I.push({...T.find(C=>C.id===D.gravityId),pollDetails:[{...D,votes:N}]}),I},[]))}return[e,o,n,i,(c,_)=>_.name===c.artist]}class Se extends fe{constructor(t){super(),ue(this,t,be,ve,oe,{})}}export{Se as component};
