import{s as oe,n as z,d as W,m as ce,c as O}from"../chunks/scheduler.7ddvVGuS.js";import{S as fe,i as ue,g as b,h as y,j as w,f,k as m,a as d,s as U,c as V,e as H,A as K,m as $,n as q,x as S,o as M}from"../chunks/index.XmLGRVaW.js";import{C as J,S as X,$ as de,e as B}from"../chunks/apis.W9dsQ1rZ.js";import{g as Y}from"../chunks/assets.UUTeAooi.js";import{f as Z}from"../chunks/units.vVRppVb4.js";function x(n,t,s){const l=n.slice();return l[7]=t[s],l}function ee(n,t,s){const l=n.slice();return l[10]=t[s],l}function te(n,t,s){const l=n.slice();return l[13]=t[s],l[15]=s,l}function he(n){let t,s,l,a,i,e,o,r,u;return{c(){t=b("div"),s=U(),l=b("div"),a=U(),i=b("div"),e=U(),o=b("div"),r=U(),u=b("div"),this.h()},l(c){t=y(c,"DIV",{class:!0}),w(t).forEach(f),s=V(c),l=y(c,"DIV",{class:!0}),w(l).forEach(f),a=V(c),i=y(c,"DIV",{class:!0}),w(i).forEach(f),e=V(c),o=y(c,"DIV",{class:!0}),w(o).forEach(f),r=V(c),u=y(c,"DIV",{class:!0}),w(u).forEach(f),this.h()},h(){m(t,"class","placeholder svelte-1fyixrn"),m(l,"class","placeholder svelte-1fyixrn"),m(i,"class","placeholder svelte-1fyixrn"),m(o,"class","placeholder svelte-1fyixrn"),m(u,"class","placeholder halfPlaceholder svelte-1fyixrn")},m(c,_){d(c,t,_),d(c,s,_),d(c,l,_),d(c,a,_),d(c,i,_),d(c,e,_),d(c,o,_),d(c,r,_),d(c,u,_)},p:z,d(c){c&&(f(t),f(s),f(l),f(a),f(i),f(e),f(o),f(r),f(u))}}}function _e(n){let t,s=B(n[0]),l=[];for(let a=0;a<s.length;a+=1)l[a]=ne(x(n,s,a));return{c(){for(let a=0;a<l.length;a+=1)l[a].c();t=H()},l(a){for(let i=0;i<l.length;i+=1)l[i].l(a);t=H()},m(a,i){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(a,i);d(a,t,i)},p(a,i){if(i&7){s=B(a[0]);let e;for(e=0;e<s.length;e+=1){const o=x(a,s,e);l[e]?l[e].p(o,i):(l[e]=ne(o),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=s.length}},d(a){a&&f(t),K(l,a)}}}function le(n){let t,s,l,a,i=n[10].title+"",e,o,r;return{c(){t=b("hr"),s=U(),l=b("p"),a=b("b"),e=$(i),o=U(),r=b("hr"),this.h()},l(u){t=y(u,"HR",{class:!0}),s=V(u),l=y(u,"P",{class:!0});var c=w(l);a=y(c,"B",{});var _=w(a);e=q(_,i),_.forEach(f),c.forEach(f),o=V(u),r=y(u,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn"),m(l,"class","poll svelte-1fyixrn"),m(r,"class","split svelte-1fyixrn")},m(u,c){d(u,t,c),d(u,s,c),d(u,l,c),S(l,a),S(a,e),d(u,o,c),d(u,r,c)},p(u,c){c&1&&i!==(i=u[10].title+"")&&M(e,i)},d(u){u&&(f(t),f(s),f(l),f(o),f(r))}}}function me(n){let t,s,l,a,i,e=(n[10].choices[n[13].candidate].title||re(n[10],n[13].candidate))+"",o;return{c(){t=b("img"),a=U(),i=b("p"),o=$(e),this.h()},l(r){t=y(r,"IMG",{src:!0,alt:!0,class:!0}),a=V(r),i=y(r,"P",{});var u=w(i);o=q(u,e),u.forEach(f),this.h()},h(){O(t.src,s=n[10].choices[n[13].candidate].txImageUrl)||m(t,"src",s),m(t,"alt",l=n[10].choices[n[13].candidate].title),m(t,"class","svelte-1fyixrn")},m(r,u){d(r,t,u),d(r,a,u),d(r,i,u),S(i,o)},p(r,u){u&1&&!O(t.src,s=r[10].choices[r[13].candidate].txImageUrl)&&m(t,"src",s),u&1&&l!==(l=r[10].choices[r[13].candidate].title)&&m(t,"alt",l),u&1&&e!==(e=(r[10].choices[r[13].candidate].title||re(r[10],r[13].candidate))+"")&&M(o,e)},d(r){r&&(f(t),f(a),f(i))}}}function pe(n){let t,s,l=n[2]("profile.votes.unrevealed")+"",a;return{c(){t=b("p"),s=b("i"),a=$(l)},l(i){t=y(i,"P",{});var e=w(t);s=y(e,"I",{});var o=w(s);a=q(o,l),o.forEach(f),e.forEach(f)},m(i,e){d(i,t,e),S(t,s),S(s,a)},p(i,e){e&4&&l!==(l=i[2]("profile.votes.unrevealed")+"")&&M(a,l)},d(i){i&&f(t)}}}function ie(n){let t;return{c(){t=b("hr"),this.h()},l(s){t=y(s,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn")},m(s,l){d(s,t,l)},d(s){s&&f(t)}}}function se(n){let t,s=new Date(Number(n[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"",l,a,i=new Date(Number(n[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"",e,o,r,u,c,_=Number(Z(n[13].amount)).toLocaleString("en-US")+"",T,P,v,g,E,p,I,D,R,L;function C(...h){return n[4](n[7],...h)}function G(h,k){return h[13].candidate===null?pe:me}let A=G(n),j=A(n),N=n[10].votes.length>1&&n[15]<n[10].votes.length-1&&ie();return{c(){t=b("p"),l=$(s),a=$(`,
                                `),e=$(i),o=U(),r=b("hr"),u=U(),c=b("div"),T=$(_),P=U(),v=b("img"),E=U(),p=b("hr"),I=U(),D=b("div"),j.c(),R=U(),N&&N.c(),L=H(),this.h()},l(h){t=y(h,"P",{class:!0});var k=w(t);l=q(k,s),a=q(k,`,
                                `),e=q(k,i),k.forEach(f),o=V(h),r=y(h,"HR",{class:!0}),u=V(h),c=y(h,"DIV",{class:!0});var F=w(c);T=q(F,_),P=V(F),v=y(F,"IMG",{src:!0,alt:!0,class:!0}),F.forEach(f),E=V(h),p=y(h,"HR",{class:!0}),I=V(h),D=y(h,"DIV",{class:!0});var Q=w(D);j.l(Q),Q.forEach(f),R=V(h),N&&N.l(h),L=H(),this.h()},h(){m(t,"class","date svelte-1fyixrn"),m(r,"class","vertical svelte-1fyixrn"),O(v.src,g=Y(n[1].find(C)||n[1][0]).como)||m(v,"src",g),m(v,"alt","COMO"),m(v,"class","svelte-1fyixrn"),m(c,"class","como svelte-1fyixrn"),m(p,"class","vertical svelte-1fyixrn"),m(D,"class","choice svelte-1fyixrn")},m(h,k){d(h,t,k),S(t,l),S(t,a),S(t,e),d(h,o,k),d(h,r,k),d(h,u,k),d(h,c,k),S(c,T),S(c,P),S(c,v),d(h,E,k),d(h,p,k),d(h,I,k),d(h,D,k),j.m(D,null),d(h,R,k),N&&N.m(h,k),d(h,L,k)},p(h,k){n=h,k&1&&s!==(s=new Date(Number(n[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"")&&M(l,s),k&1&&i!==(i=new Date(Number(n[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"")&&M(e,i),k&1&&_!==(_=Number(Z(n[13].amount)).toLocaleString("en-US")+"")&&M(T,_),k&3&&!O(v.src,g=Y(n[1].find(C)||n[1][0]).como)&&m(v,"src",g),A===(A=G(n))&&j?j.p(n,k):(j.d(1),j=A(n),j&&(j.c(),j.m(D,null))),n[10].votes.length>1&&n[15]<n[10].votes.length-1?N||(N=ie(),N.c(),N.m(L.parentNode,L)):N&&(N.d(1),N=null)},d(h){h&&(f(t),f(o),f(r),f(u),f(c),f(E),f(p),f(I),f(D),f(R),f(L)),j.d(),N&&N.d(h)}}}function ae(n){let t,s,l=n[7].polls.length>1&&le(n),a=B(n[10].votes),i=[];for(let e=0;e<a.length;e+=1)i[e]=se(te(n,a,e));return{c(){l&&l.c(),t=U();for(let e=0;e<i.length;e+=1)i[e].c();s=H()},l(e){l&&l.l(e),t=V(e);for(let o=0;o<i.length;o+=1)i[o].l(e);s=H()},m(e,o){l&&l.m(e,o),d(e,t,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,o);d(e,s,o)},p(e,o){if(e[7].polls.length>1?l?l.p(e,o):(l=le(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null),o&7){a=B(e[10].votes);let r;for(r=0;r<a.length;r+=1){const u=te(e,a,r);i[r]?i[r].p(u,o):(i[r]=se(u),i[r].c(),i[r].m(s.parentNode,s))}for(;r<i.length;r+=1)i[r].d(1);i.length=a.length}},d(e){e&&(f(t),f(s)),l&&l.d(e),K(i,e)}}}function ne(n){let t,s,l,a=n[7].title+"",i,e,o,r,u,c,_,T,P=B(n[7].pollDetails),v=[];for(let g=0;g<P.length;g+=1)v[g]=ae(ee(n,P,g));return{c(){t=b("div"),s=b("div"),l=b("b"),i=$(a),e=U(),o=b("img"),c=U(),_=b("div");for(let g=0;g<v.length;g+=1)v[g].c();T=U(),this.h()},l(g){t=y(g,"DIV",{class:!0});var E=w(t);s=y(E,"DIV",{class:!0});var p=w(s);l=y(p,"B",{});var I=w(l);i=q(I,a),I.forEach(f),e=V(p),o=y(p,"IMG",{src:!0,alt:!0,class:!0}),p.forEach(f),c=V(E),_=y(E,"DIV",{class:!0});var D=w(_);for(let R=0;R<v.length;R+=1)v[R].l(D);D.forEach(f),T=V(E),E.forEach(f),this.h()},h(){O(o.src,r=n[7].bannerImageUrl)||m(o,"src",r),m(o,"alt",u=n[7].title),m(o,"class","svelte-1fyixrn"),m(s,"class","header svelte-1fyixrn"),m(_,"class","content svelte-1fyixrn"),m(t,"class","gravity svelte-1fyixrn")},m(g,E){d(g,t,E),S(t,s),S(s,l),S(l,i),S(s,e),S(s,o),S(t,c),S(t,_);for(let p=0;p<v.length;p+=1)v[p]&&v[p].m(_,null);S(t,T)},p(g,E){if(E&1&&a!==(a=g[7].title+"")&&M(i,a),E&1&&!O(o.src,r=g[7].bannerImageUrl)&&m(o,"src",r),E&1&&u!==(u=g[7].title)&&m(o,"alt",u),E&7){P=B(g[7].pollDetails);let p;for(p=0;p<P.length;p+=1){const I=ee(g,P,p);v[p]?v[p].p(I,E):(v[p]=ae(I),v[p].c(),v[p].m(_,null))}for(;p<v.length;p+=1)v[p].d(1);v.length=P.length}},d(g){g&&f(t),K(v,g)}}}function ve(n){let t;function s(i,e){return i[0]?_e:he}let l=s(n),a=l(n);return{c(){t=b("div"),a.c(),this.h()},l(i){t=y(i,"DIV",{class:!0});var e=w(t);a.l(e),e.forEach(f),this.h()},h(){m(t,"class","layout svelte-1fyixrn")},m(i,e){d(i,t,e),a.m(t,null)},p(i,[e]){l===(l=s(i))&&a?a.p(i,e):(a.d(1),a=l(i),a&&(a.c(),a.m(t,null)))},i:z,o:z,d(i){i&&f(t),a.d()}}}function ge(n,t){const s=e=>new Date(e.startDate).getTime()<=n.timestamp&&new Date(e.endDate).getTime()>=n.timestamp,l=t.polls.find(e=>e.pollIdOnChain==n.poll&&s(e));if(l)return l;const a=t.polls.find(e=>e.id==n.poll&&s(e));if(a)return a;const i=t.polls.find(e=>e.id-1==n.poll&&s(e));return i||t.polls.find(e=>e.id+1==n.poll&&s(e))}function re(n,t){const s=n.pollViewMetadata;if(s.slots){const l=s.choiceIdToSlotChoicesMapTable[t];return s.slots.map((a,i)=>`${a.name}: ${s.slotChoices?.find(e=>e.id===l.slotChoiceIds[i])?.name}`).join(", ")}return n.choices[t].id}function be(n,t,s){let l,a;W(n,de,c=>s(2,a=c));const i=ce("address");W(n,i,c=>s(5,l=c));let e,o;J.artists().then(c=>{s(1,o=c),r()});async function r(){const _=await(await fetch(`${J.URL}/gravity/v3`)).json(),T=[..._.upcoming,..._.ongoing,..._.past],E=(await(await fetch(X.URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
                    query {
                        votesConnection(orderBy: timestamp_DESC, where: {from_eq: "${l}"}) {
                            edges {
                                node {
                                    ${Object.keys(X.Vote).join(`
`)}
                                }
                            }
                        }
                    }
                `})})).json()).data.votesConnection.edges.map(I=>I.node).reduce((I,D)=>{const R=I.find(L=>L.votes.find(C=>C.poll===D.poll&&C.contract===D.contract));if(R)R.votes.unshift(D);else{const L=o.find(C=>C.contracts.Governor.toLowerCase()===D.contract);for(const C of T){if(C.artist!==L?.name)continue;const G=ge(D,C);if(G){I.push({...G,votes:[D],gravity:C});break}}}return I},[]),p=await Promise.all(E.map(async I=>(await(await fetch(`${J.URL}/gravity/v3/${I.gravity.artist}/gravity/${I.gravity.id}/polls/${I.id}`)).json()).pollDetail));s(0,e=p.reduce((I,D)=>{const R=I.find(C=>C.id===D.gravityId),L=E.find(C=>C.id===D.id).votes;return R?R.pollDetails.unshift({...D,votes:L}):I.push({...T.find(C=>C.id===D.gravityId),pollDetails:[{...D,votes:L}]}),I},[]))}return[e,o,a,i,(c,_)=>_.name===c.artist]}class Se extends fe{constructor(t){super(),ue(this,t,be,ve,oe,{})}}export{Se as component};
