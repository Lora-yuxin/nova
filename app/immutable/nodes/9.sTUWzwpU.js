import{s as oe,n as z,c as W,g as ce,e as B}from"../chunks/scheduler.nSpB3e7h.js";import{S as fe,i as ue,e as D,c as I,a as w,d as f,u as m,g as h,s as V,f as R,w as G,v as K,t as M,b as O,h as S,j as H}from"../chunks/index.EYyPxix3.js";import{C as J,S as X,$ as he,e as A}from"../chunks/apis.S3U1-Zzk.js";import{g as Y}from"../chunks/assets.lJdVPpet.js";import{f as Z}from"../chunks/units.g_UJoWng.js";function x(r,t,i){const l=r.slice();return l[7]=t[i],l}function ee(r,t,i){const l=r.slice();return l[10]=t[i],l}function te(r,t,i){const l=r.slice();return l[13]=t[i],l[15]=i,l}function de(r){let t,i,l,n,s,e,o,a,u;return{c(){t=D("div"),i=V(),l=D("div"),n=V(),s=D("div"),e=V(),o=D("div"),a=V(),u=D("div"),this.h()},l(c){t=I(c,"DIV",{class:!0}),w(t).forEach(f),i=R(c),l=I(c,"DIV",{class:!0}),w(l).forEach(f),n=R(c),s=I(c,"DIV",{class:!0}),w(s).forEach(f),e=R(c),o=I(c,"DIV",{class:!0}),w(o).forEach(f),a=R(c),u=I(c,"DIV",{class:!0}),w(u).forEach(f),this.h()},h(){m(t,"class","placeholder svelte-1fyixrn"),m(l,"class","placeholder svelte-1fyixrn"),m(s,"class","placeholder svelte-1fyixrn"),m(o,"class","placeholder svelte-1fyixrn"),m(u,"class","placeholder halfPlaceholder svelte-1fyixrn")},m(c,_){h(c,t,_),h(c,i,_),h(c,l,_),h(c,n,_),h(c,s,_),h(c,e,_),h(c,o,_),h(c,a,_),h(c,u,_)},p:z,d(c){c&&(f(t),f(i),f(l),f(n),f(s),f(e),f(o),f(a),f(u))}}}function _e(r){let t,i=A(r[0]),l=[];for(let n=0;n<i.length;n+=1)l[n]=re(x(r,i,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();t=G()},l(n){for(let s=0;s<l.length;s+=1)l[s].l(n);t=G()},m(n,s){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(n,s);h(n,t,s)},p(n,s){if(s&7){i=A(n[0]);let e;for(e=0;e<i.length;e+=1){const o=x(n,i,e);l[e]?l[e].p(o,s):(l[e]=re(o),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=i.length}},d(n){n&&f(t),K(l,n)}}}function le(r){let t,i,l,n,s=r[10].title+"",e,o,a;return{c(){t=D("hr"),i=V(),l=D("p"),n=D("b"),e=M(s),o=V(),a=D("hr"),this.h()},l(u){t=I(u,"HR",{class:!0}),i=R(u),l=I(u,"P",{class:!0});var c=w(l);n=I(c,"B",{});var _=w(n);e=O(_,s),_.forEach(f),c.forEach(f),o=R(u),a=I(u,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn"),m(l,"class","poll svelte-1fyixrn"),m(a,"class","split svelte-1fyixrn")},m(u,c){h(u,t,c),h(u,i,c),h(u,l,c),S(l,n),S(n,e),h(u,o,c),h(u,a,c)},p(u,c){c&1&&s!==(s=u[10].title+"")&&H(e,s)},d(u){u&&(f(t),f(i),f(l),f(o),f(a))}}}function me(r){let t,i,l,n,s,e=(r[10].choices[r[13].candidate].title||ae(r[10],r[13].candidate))+"",o;return{c(){t=D("img"),n=V(),s=D("p"),o=M(e),this.h()},l(a){t=I(a,"IMG",{src:!0,alt:!0,class:!0}),n=R(a),s=I(a,"P",{});var u=w(s);o=O(u,e),u.forEach(f),this.h()},h(){B(t.src,i=r[10].choices[r[13].candidate].txImageUrl)||m(t,"src",i),m(t,"alt",l=r[10].choices[r[13].candidate].title),m(t,"class","svelte-1fyixrn")},m(a,u){h(a,t,u),h(a,n,u),h(a,s,u),S(s,o)},p(a,u){u&1&&!B(t.src,i=a[10].choices[a[13].candidate].txImageUrl)&&m(t,"src",i),u&1&&l!==(l=a[10].choices[a[13].candidate].title)&&m(t,"alt",l),u&1&&e!==(e=(a[10].choices[a[13].candidate].title||ae(a[10],a[13].candidate))+"")&&H(o,e)},d(a){a&&(f(t),f(n),f(s))}}}function pe(r){let t,i,l=r[2]("profile.votes.unrevealed")+"",n;return{c(){t=D("p"),i=D("i"),n=M(l)},l(s){t=I(s,"P",{});var e=w(t);i=I(e,"I",{});var o=w(i);n=O(o,l),o.forEach(f),e.forEach(f)},m(s,e){h(s,t,e),S(t,i),S(i,n)},p(s,e){e&4&&l!==(l=s[2]("profile.votes.unrevealed")+"")&&H(n,l)},d(s){s&&f(t)}}}function se(r){let t;return{c(){t=D("hr"),this.h()},l(i){t=I(i,"HR",{class:!0}),this.h()},h(){m(t,"class","split svelte-1fyixrn")},m(i,l){h(i,t,l)},d(i){i&&f(t)}}}function ie(r){let t,i=new Date(Number(r[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"",l,n,s=new Date(Number(r[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"",e,o,a,u,c,_=Number(Z(r[13].amount)).toLocaleString("en-US")+"",j,P,v,b,E,p,T,g,y,C;function L(...d){return r[4](r[7],...d)}function U(d,k){return d[13].candidate===null?pe:me}let $=U(r),q=$(r),N=r[10].votes.length>1&&r[15]<r[10].votes.length-1&&se();return{c(){t=D("p"),l=M(i),n=M(`,
                                `),e=M(s),o=V(),a=D("hr"),u=V(),c=D("div"),j=M(_),P=V(),v=D("img"),E=V(),p=D("hr"),T=V(),g=D("div"),q.c(),y=V(),N&&N.c(),C=G(),this.h()},l(d){t=I(d,"P",{class:!0});var k=w(t);l=O(k,i),n=O(k,`,
                                `),e=O(k,s),k.forEach(f),o=R(d),a=I(d,"HR",{class:!0}),u=R(d),c=I(d,"DIV",{class:!0});var F=w(c);j=O(F,_),P=R(F),v=I(F,"IMG",{src:!0,alt:!0,class:!0}),F.forEach(f),E=R(d),p=I(d,"HR",{class:!0}),T=R(d),g=I(d,"DIV",{class:!0});var Q=w(g);q.l(Q),Q.forEach(f),y=R(d),N&&N.l(d),C=G(),this.h()},h(){m(t,"class","date svelte-1fyixrn"),m(a,"class","vertical svelte-1fyixrn"),B(v.src,b=Y(r[1].find(L)||r[1][0]).como)||m(v,"src",b),m(v,"alt","COMO"),m(v,"class","svelte-1fyixrn"),m(c,"class","como svelte-1fyixrn"),m(p,"class","vertical svelte-1fyixrn"),m(g,"class","choice svelte-1fyixrn")},m(d,k){h(d,t,k),S(t,l),S(t,n),S(t,e),h(d,o,k),h(d,a,k),h(d,u,k),h(d,c,k),S(c,j),S(c,P),S(c,v),h(d,E,k),h(d,p,k),h(d,T,k),h(d,g,k),q.m(g,null),h(d,y,k),N&&N.m(d,k),h(d,C,k)},p(d,k){r=d,k&1&&i!==(i=new Date(Number(r[13].timestamp)).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"})+"")&&H(l,i),k&1&&s!==(s=new Date(Number(r[13].timestamp)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})+"")&&H(e,s),k&1&&_!==(_=Number(Z(r[13].amount)).toLocaleString("en-US")+"")&&H(j,_),k&3&&!B(v.src,b=Y(r[1].find(L)||r[1][0]).como)&&m(v,"src",b),$===($=U(r))&&q?q.p(r,k):(q.d(1),q=$(r),q&&(q.c(),q.m(g,null))),r[10].votes.length>1&&r[15]<r[10].votes.length-1?N||(N=se(),N.c(),N.m(C.parentNode,C)):N&&(N.d(1),N=null)},d(d){d&&(f(t),f(o),f(a),f(u),f(c),f(E),f(p),f(T),f(g),f(y),f(C)),q.d(),N&&N.d(d)}}}function ne(r){let t,i,l=r[7].polls.length>1&&le(r),n=A(r[10].votes),s=[];for(let e=0;e<n.length;e+=1)s[e]=ie(te(r,n,e));return{c(){l&&l.c(),t=V();for(let e=0;e<s.length;e+=1)s[e].c();i=G()},l(e){l&&l.l(e),t=R(e);for(let o=0;o<s.length;o+=1)s[o].l(e);i=G()},m(e,o){l&&l.m(e,o),h(e,t,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,o);h(e,i,o)},p(e,o){if(e[7].polls.length>1?l?l.p(e,o):(l=le(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null),o&7){n=A(e[10].votes);let a;for(a=0;a<n.length;a+=1){const u=te(e,n,a);s[a]?s[a].p(u,o):(s[a]=ie(u),s[a].c(),s[a].m(i.parentNode,i))}for(;a<s.length;a+=1)s[a].d(1);s.length=n.length}},d(e){e&&(f(t),f(i)),l&&l.d(e),K(s,e)}}}function re(r){let t,i,l,n=r[7].title+"",s,e,o,a,u,c,_,j,P=A(r[7].pollDetails),v=[];for(let b=0;b<P.length;b+=1)v[b]=ne(ee(r,P,b));return{c(){t=D("div"),i=D("div"),l=D("b"),s=M(n),e=V(),o=D("img"),c=V(),_=D("div");for(let b=0;b<v.length;b+=1)v[b].c();j=V(),this.h()},l(b){t=I(b,"DIV",{class:!0});var E=w(t);i=I(E,"DIV",{class:!0});var p=w(i);l=I(p,"B",{});var T=w(l);s=O(T,n),T.forEach(f),e=R(p),o=I(p,"IMG",{src:!0,alt:!0,class:!0}),p.forEach(f),c=R(E),_=I(E,"DIV",{class:!0});var g=w(_);for(let y=0;y<v.length;y+=1)v[y].l(g);g.forEach(f),j=R(E),E.forEach(f),this.h()},h(){B(o.src,a=r[7].bannerImageUrl)||m(o,"src",a),m(o,"alt",u=r[7].title),m(o,"class","svelte-1fyixrn"),m(i,"class","header svelte-1fyixrn"),m(_,"class","content svelte-1fyixrn"),m(t,"class","gravity svelte-1fyixrn")},m(b,E){h(b,t,E),S(t,i),S(i,l),S(l,s),S(i,e),S(i,o),S(t,c),S(t,_);for(let p=0;p<v.length;p+=1)v[p]&&v[p].m(_,null);S(t,j)},p(b,E){if(E&1&&n!==(n=b[7].title+"")&&H(s,n),E&1&&!B(o.src,a=b[7].bannerImageUrl)&&m(o,"src",a),E&1&&u!==(u=b[7].title)&&m(o,"alt",u),E&7){P=A(b[7].pollDetails);let p;for(p=0;p<P.length;p+=1){const T=ee(b,P,p);v[p]?v[p].p(T,E):(v[p]=ne(T),v[p].c(),v[p].m(_,null))}for(;p<v.length;p+=1)v[p].d(1);v.length=P.length}},d(b){b&&f(t),K(v,b)}}}function ve(r){let t;function i(s,e){return s[0]?_e:de}let l=i(r),n=l(r);return{c(){t=D("div"),n.c(),this.h()},l(s){t=I(s,"DIV",{class:!0});var e=w(t);n.l(e),e.forEach(f),this.h()},h(){m(t,"class","layout svelte-1fyixrn")},m(s,e){h(s,t,e),n.m(t,null)},p(s,[e]){l===(l=i(s))&&n?n.p(s,e):(n.d(1),n=l(s),n&&(n.c(),n.m(t,null)))},i:z,o:z,d(s){s&&f(t),n.d()}}}function ge(r,t){const i=e=>new Date(e.startDate).getTime()<=r.timestamp&&new Date(e.endDate).getTime()>=r.timestamp,l=t.polls.find(e=>e.pollIdOnChain==r.poll&&i(e));if(l)return l;const n=t.polls.find(e=>e.id==r.poll&&i(e));if(n)return n;const s=t.polls.find(e=>e.id-1==r.poll&&i(e));return s||t.polls.find(e=>e.id+1==r.poll&&i(e))}function ae(r,t){const i=r.pollViewMetadata;if(i.slots){const l=i.choiceIdToSlotChoicesMapTable[t];return i.slots.map((n,s)=>{var e,o;return`${n.name}: ${(o=(e=i.slotChoices)==null?void 0:e.find(a=>a.id===l.slotChoiceIds[s]))==null?void 0:o.name}`}).join(", ")}return r.choices[t].id}function be(r,t,i){let l,n;W(r,he,c=>i(2,n=c));const s=ce("address");W(r,s,c=>i(5,l=c));let e,o;J.artists().then(c=>{i(1,o=c),a()});async function a(){const _=await(await fetch(`${J.URL}/gravity/v3`)).json(),j=[..._.upcoming,..._.ongoing,..._.past],E=(await(await fetch(X.URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
                    query {
                        votesConnection(orderBy: timestamp_DESC, where: {from_eq: "${l}"}) {
                            edges {
                                node {
                                    ${Object.keys(X.Vote).join(`
`)}
                                }
                            }
                        }
                    }
                `})})).json()).data.votesConnection.edges.map(g=>g.node).reduce((g,y)=>{const C=g.find(L=>L.votes.find(U=>U.poll===y.poll&&U.contract===y.contract));if(C)C.votes.unshift(y);else{const L=o.find(U=>U.contracts.Governor.toLowerCase()===y.contract);for(const U of j){if(U.artist!==(L==null?void 0:L.name))continue;const $=ge(y,U);if($){g.push({...$,votes:[y],gravity:U});break}}}return g},[]),p=E.reduce((g,y)=>{const C=g.find(L=>L[0].artist===y.artist);return C?C.push(y):g.push([y]),g},[]),T=(await Promise.all(p.map(async g=>await(await fetch(`${J.URL}/gravity/v3.1/${g[0].artist}/polls/${g.map(C=>C.id).join(",")}`)).json()))).flat();i(0,e=T.reduce((g,y)=>{const C=g.find(U=>U.id===y.gravityId),L=E.find(U=>U.id===y.id).votes;return C?C.pollDetails.unshift({...y,votes:L}):g.push({...j.find(U=>U.id===y.gravityId),pollDetails:[{...y,votes:L}]}),g},[]))}return[e,o,n,s,(c,_)=>_.name===c.artist]}class Se extends fe{constructor(t){super(),ue(this,t,be,ve,oe,{})}}export{Se as component};
